#!/bin/bash

# Starting options
MAIN_OPTION=$(printf "ğŸ“ Create a new note\nğŸ“’ Open existing notes\nğŸš® Delete notes" | rofi -dmenu -i -theme-str 'entry {placeholder:"ô€Š« Manage notes";}')

if [ "$MAIN_OPTION" = "ğŸ“ Create a new note" ]; then
    NOTE_NAME=$(rofi -dmenu -theme-str 'entry {placeholder:"âœï¸ Enter note name";}')
    if [ -z "$NOTE_NAME" ]; then
	exit
    fi
    DIRECTORY=$(dirname $NOTE_NAME)
    mkdir -p ~/Notes/$DIRECTORY
    touch ~/Notes/$NOTE_NAME.org
    (pidof emacs && emacsclient -n -c ~/Notes/$NOTE_NAME.org) || (emacs --daemon && emacsclient -n -c ~/Notes/$NOTE_NAME.org)
elif [ "$MAIN_OPTION" = "ğŸ“’ Open existing notes" ]; then
    NOTES=$(find ~/Notes -name "*.org" | cut -sd / -f 5- | cut -d "." -f 1 | rofi -dmenu -i)
    if [ -z "$NOTES" ]; then
	exit
    fi
    (pidof emacs && emacsclient -n -c ~/Notes/$NOTES.org) || (emacs --daemon && emacsclient -n -c ~/Notes/$NOTES.org)
elif [ "$MAIN_OPTION" = "ğŸš® Delete notes" ]; then
    NOTES=$(find ~/Notes -name "*.org" | cut -sd / -f 5- | cut -d "." -f 1 | rofi -dmenu -i)
    if [ -z "$NOTES" ]; then
	exit
    fi
    rm ~/Notes/$NOTES.org
fi
